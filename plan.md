# 대형마트 혼잡도 예측 서비스 기획서 (v1.2)

## 1. 개요

**1.1. 프로젝트 목표**
- 사용자가 지정한 날짜와 대형마트의 시간대별 예상 혼잡도를 제공하여, 사용자가 보다 쾌적한 시간에 쇼핑할 수 있도록 돕는 웹 애플리케이션을 개발합니다.

**1.2. 개발 환경**
- **IDE:** Firebase Studio (`studio.firebase.google.com`)
- **CLI:** `geminicli`
- **배포:** Firebase Hosting (권장)

**1.3. 타겟 사용자**
- 대형마트 방문 시 붐비는 시간을 피하고 싶은 모든 소비자

## 2. 주요 기능

**2.1. 사용자 입력**
- **방문 지역:** 아래 목록에서 지역을 선택합니다.
  - 서울 강남, 안양 평촌, 군포 산본, 경기 의왕, 서울 양재, 경기 광명
- **대형마트 선택:** 아래 목록에서 마트 브랜드를 선택합니다.
  - 이마트, 홈플러스, 트레이더스 클럽, 코스트코, 롯데마트
- **방문 날짜:** 캘린더 UI를 통해 원하는 방문 날짜를 선택합니다.

**2.2. 결과 출력**
- 선택한 날짜의 시간대별 예상 혼잡도를 4단계로 나누어 시각적으로 표시합니다.
  - **원활**, **보통**, **혼잡**, **매우 혼잡**
- 혼잡도 정보와 함께 데이터의 출처를 명시합니다.
  - **API**: Cloudflare API를 통해 가져온 데이터
  - **통계**: 통계 기반 추정 모델 (Fallback)을 통해 생성된 데이터

## 3. 데이터 아키텍처

**3.1. 데이터 소스**
- **주 소스 (Primary): Cloudflare API**
  - 사용자가 제공하는 Cloudflare API 엔드포인트를 호출하여 실시간에 가까운 혼잡도 데이터를 가져오는 것을 목표로 합니다.
  - API 명세 (가정): `GET /congestion?date=YYYY-MM-DD&mart=MART_CODE&region=REGION_CODE`
  - 예상 응답 (JSON): `{"hourly_congestion": [ { "hour": 10, "level": "원활" }, ... ], "source": "api"}`
- **대체 소스 (Fallback): 통계 기반 추정 모델**
  - API 호출에 실패하거나, 응답이 없는 경우 또는 개발 초기 단계에서 아래의 자체 추정 모델을 사용하여 예상 혼잡도를 제공합니다.
  - 예상 응답 (JSON): `{"hourly_congestion": [ { "hour": 10, "level": "원활" }, ... ], "source": "통계"}`

**3.2. 통계 기반 추정 모델 (Heuristic Model)**
- 신한카드 트렌드, 오픈서베이 리포트 등 공개된 데이터를 기반으로 가중치를 조합하여 혼잡도를 계산합니다.
  - **요일 가중치:** 평일 < 주말 < 공휴일 순으로 가중치 부여
  - **시간대 가중치:** 저녁(18~21시)과 주말 오후 시간대에 높은 가중치 부여
  - **마트 유형 가중치:** 창고형 매장은 주말에 가중치 추가
  - **최종 혼잡도:** `점수 = 요일 * 시간대 * 마트` 가중치를 조합하여 4단계 레벨로 변환

## 4. 기술 스택

- **HTML**: 애플리케이션의 기본 구조를 정의합니다.
- **CSS**: 사용자가 보기 편하고 직관적인 UI를 디자인합니다. (모바일 반응형 포함)
- **JavaScript**:
  - `fetch` API를 사용하여 Cloudflare API에 비동기 요청을 보냅니다.
  - 사용자 입력을 받아 API 호출 또는 Fallback 모델 실행을 결정합니다.
  - 결과를 동적으로 화면에 렌더링합니다.

## 5. 화면 설계 (UI/UX)

- **상단 (입력 영역):**
  - "대형마트 혼잡도 조회" 제목
  - 방문 지역 (드롭다운), 마트 종류 (드롭다운), 방문 날짜 (캘린더)를 선택할 수 있는 입력 필드
  - "혼잡도 확인하기" 버튼

- **하단 (결과 영역):**
  - 초기에는 비어있으며, "혼잡도 확인하기" 버튼 클릭 시 표시됩니다.
  - "2026년 O월 O일 (O요일) 이마트 예상 혼잡도 (출처: API/통계)" 와 같은 결과 제목
  - 시간대와 예상 혼잡도(예: 18:00 - 19:00: **매우 혼잡**)가 나열된 리스트 또는 간단한 막대그래프

## 6. 개발 단계

1.  **기획서 업데이트 및 승인:** (현재 단계)
2.  **HTML 기본 구조 설정:** `index.html` 파일에 입력과 결과 영역의 뼈대를 만듭니다.
3.  **CSS 스타일링:** `style.css` 파일에 전체적인 디자인과 레이아웃을 구현합니다.
4.  **JavaScript API 연동 모듈 개발:**
    - `main.js`에 `fetch`를 사용하여 지정된 Cloudflare API를 호출하는 함수를 구현합니다.
    - 성공, 실패 등 다양한 응답에 대응하는 로직을 포함합니다.
5.  **JavaScript Fallback 로직 개발:**
    - 기존의 통계 기반 추정 모델 알고리즘을 별도 함수로 구현합니다.
6.  **DOM 연동 및 제어 로직 구현:**
    - "혼잡도 확인하기" 버튼 클릭 이벤트를 처리합니다.
    - API 호출을 우선 시도하고, 실패 시 Fallback 로직을 실행하여 최종 결과를 화면에 동적으로 표시합니다.
7.  **테스트 및 디버깅:** 기능이 의도대로 동작하는지 확인하고 오류를 수정합니다.
